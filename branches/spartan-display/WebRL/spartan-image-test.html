<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
		<link rel="stylesheet" type="text/css" href="WebRL.css">
		<title>WebRL</title>

		<script type="application/javascript" src="http://www.google.com/jsapi"></script>

		<script type="application/javascript">
			google.load("jquery", "1.3.2");
			var scrWidth = 80;
			var scrHeight = 25;
		</script>
		<script type="application/javascript" src="./js/SpartanDisplay.js"></script>

		<link rel="stylesheet" type="text/css" href="./WebRLSpartan.css">
	</head>
	<body>
		<h1>WebRL</h1>
		<div id="spartanScreen">
		</div>

		<script type="application/javascript">
			$(document).ready(function() {
				scrWidth = 80;
				scrHeight = 25;

				var opt = PerformanceTimer();

				var w = scrWidth, h = scrHeight;

				for(var x=0;x<w;x++) {
					for(var y=0;y<h;y++) {
						// A red . on a gray background.
						scr.cells[x][y].set( "2E", "ff0000", "808080" );
					}
				}

				var px = 10, py = 10;
				// A blue @ on a green background
				scr.cells[px][py].set( "40", "0000ff", "808080" );
				scr.update();


				$(document).keypress(function(e) {
					var e = window.event || e;
					var code = (e.keyCode == 0) ? e.charCode : e.keyCode ;

					var oldPx = px;
					var oldPy = py;

					
					switch( code ) {
						case 37:
							px--;
							break;
						case 38:
							py--;
							break;
						case 39:
							px++;
							break;
						case 40:
							py++;
							break;
						default:
							return true;
					}
					if( oldPx != px || oldPy != py ) {
						var pt = PerformanceTimer();
						for(var x=0;x<w;x++) {
							for(var y=0;y<h;y++) {
								// This is just a stress test..
								scr.cells[x][y].set( "2E", "ff0000", "808080" );
							}
						}
						scr.cells[oldPx][oldPy].set( "2E", "ff0000", "808080" );
						scr.cells[px][py].set( "40", "0000ff", "808080" );
						scr.hackyFov( px, py );
						scr.update();
					}
					return false;
				});
				
			});
			google.load("jquery", "1.3.2");
		</script>
		<script type="application/javascript" src="./js/PerformanceTimer.js"></script>
	</body>
</html>
